services:
  opencode:
    image: ${OPENCODE_IMAGE:-ghcr.io/bon5co/opencode-webui-workspace:latest}
    container_name: kbx_opencode
    restart: unless-stopped
    environment:
      OPENCODE_SERVER_USERNAME: ${OPENCODE_SERVER_USERNAME:-opencode}
      OPENCODE_SERVER_PASSWORD: ${OPENCODE_SERVER_PASSWORD}
      OPENCODE_PORT: 4096
      OPENCODE_HOSTNAME: 0.0.0.0
    ports:
      - "${OPENCODE_PORT:-4096}:4096"
    volumes:
      - /srv/agent/opencode-workspace:/home/opencode/workspace

  login_portal:
    image: ${LOGIN_PORTAL_IMAGE:-lscr.io/linuxserver/firefox:latest}
    container_name: kbx_login_portal
    restart: unless-stopped
    shm_size: "1gb"
    environment:
      PUID: "1000"
      PGID: "1000"
      TZ: ${TZ:-UTC}
    ports:
      - "${LOGIN_PORTAL_PORT:-3001}:3000"
    volumes:
      - /srv/agent/browser-profile:/config
      - /srv/agent/dropbox:/dropbox
